# å»ä¸­å¿ƒåŒ–åº”ç”¨å¦‚ä½•ç»„æˆ

å»ä¸­å¿ƒåŒ–åº”ç”¨ï¼ˆDAppï¼‰æ˜¯ç”±å¤šä¸ªå…³é”®ç»„ä»¶ç»„æˆçš„å®Œæ•´æŠ€æœ¯æ ˆã€‚è®©æˆ‘è¯¦ç»†è§£é‡Šæ¯ä¸ªç»„æˆéƒ¨åˆ†ï¼š

## ğŸ—ï¸ DApp çš„æ ¸å¿ƒæ¶æ„å±‚æ¬¡

### ç¬¬ä¸€å±‚ï¼šåŒºå—é“¾å±‚ï¼ˆåç«¯åŸºç¡€è®¾æ–½ï¼‰
```solidity
// æ™ºèƒ½åˆçº¦ç¤ºä¾‹ - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
pragma solidity ^0.8.0;

contract SimpleDApp {
    address public owner;
    mapping(address => uint256) public balances;
    
    event Deposit(address indexed user, uint256 amount);
    
    constructor() {
        owner = msg.sender;
    }
    
    function deposit() public payable {
        balances[msg.sender] += msg.value;
        emit Deposit(msg.sender, msg.value);
    }
    
    function getBalance() public view returns (uint256) {
        return balances[msg.sender];
    }
}
```

**ç»„ä»¶åŒ…æ‹¬ï¼š**
- **æ™ºèƒ½åˆçº¦**ï¼šéƒ¨ç½²åœ¨åŒºå—é“¾ä¸Šçš„ä¸šåŠ¡é€»è¾‘
- **åŒºå—é“¾ç½‘ç»œ**ï¼šä»¥å¤ªåŠã€Polygonã€Arbitrum ç­‰
- **çŠ¶æ€å­˜å‚¨**ï¼šé“¾ä¸Šæ•°æ®å­˜å‚¨

### ç¬¬äºŒå±‚ï¼šåè®®å±‚ï¼ˆä¸­é—´ä»¶å’Œæ¥å£ï¼‰
```javascript
// Web3 è¿æ¥å±‚ - å‰ç«¯ä¸åŒºå—é“¾çš„æ¡¥æ¢
import { ethers } from 'ethers';

class DAppService {
    constructor() {
        this.provider = new ethers.providers.Web3Provider(window.ethereum);
        this.signer = this.provider.getSigner();
    }
    
    async connectContract(contractAddress, abi) {
        return new ethers.Contract(contractAddress, abi, this.signer);
    }
    
    async getAccount() {
        const accounts = await window.ethereum.request({
            method: 'eth_requestAccounts'
        });
        return accounts[0];
    }
}
```

**ç»„ä»¶åŒ…æ‹¬ï¼š**
- **Web3 åº“**ï¼šethers.jsã€web3.jsã€viem
- **RPC èŠ‚ç‚¹**ï¼šInfuraã€Alchemyã€QuickNode
- **ç´¢å¼•æœåŠ¡**ï¼šThe Graphã€Subgraph
- **Oracle**ï¼šChainlinkã€Band Protocol

### ç¬¬ä¸‰å±‚ï¼šå‰ç«¯å±‚ï¼ˆç”¨æˆ·ç•Œé¢ï¼‰
```jsx
// React å‰ç«¯ç»„ä»¶ç¤ºä¾‹
import React, { useState, useEffect } from 'react';
import { useWeb3React } from '@web3-react/core';
import { injected } from './connectors';

function DAppFrontend() {
    const { active, account, library, activate } = useWeb3React();
    const [balance, setBalance] = useState('0');
    const [contract, setContract] = useState(null);

    const connectWallet = async () => {
        try {
            await activate(injected);
        } catch (error) {
            console.error(error);
        }
    };

    const deposit = async (amount) => {
        if (contract) {
            const tx = await contract.deposit({
                value: ethers.utils.parseEther(amount)
            });
            await tx.wait();
        }
    };

    return (
        <div className="app">
            {!active ? (
                <button onClick={connectWallet}>è¿æ¥é’±åŒ…</button>
            ) : (
                <div>
                    <p>å·²è¿æ¥: {account}</p>
                    <button onClick={() => deposit('0.1')}>å­˜å…¥ 0.1 ETH</button>
                </div>
            )}
        </div>
    );
}
```

## ğŸ“ å®Œæ•´çš„ DApp é¡¹ç›®ç»“æ„

```
my-dapp/
â”œâ”€â”€ contracts/                 # æ™ºèƒ½åˆçº¦
â”‚   â”œâ”€â”€ SimpleDApp.sol
â”‚   â”œâ”€â”€ Token.sol
â”‚   â””â”€â”€ interfaces/
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ useWeb3.js
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ contracts.js
â”‚   â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ App.jsx
â”‚   â”œâ”€â”€ public/
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ scripts/                   # éƒ¨ç½²å’Œäº¤äº’è„šæœ¬
â”‚   â”œâ”€â”€ deploy.js
â”‚   â”œâ”€â”€ verify.js
â”‚   â””â”€â”€ interactions.js
â”œâ”€â”€ tests/                     # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ unit/
â”‚   â””â”€â”€ integration/
â”œâ”€â”€ hardhat.config.js          # å¼€å‘ç¯å¢ƒé…ç½®
â””â”€â”€ package.json
```

## ğŸ”§ å…³é”®æŠ€æœ¯ç»„ä»¶è¯¦è§£

### 1. é’±åŒ…é›†æˆ
```javascript
// é’±åŒ…è¿æ¥ç®¡ç†å™¨
export const connectors = {
    injected: new InjectedConnector({
        supportedChainIds: [1, 5, 137, 80001] // ä¸»ç½‘ã€Goerliã€Polygonã€Mumbai
    }),
    walletConnect: new WalletConnectConnector({
        rpc: {
            1: 'https://mainnet.infura.io/v3/your-key',
            5: 'https://goerli.infura.io/v3/your-key'
        },
        qrcode: true
    })
};

// React Hook for Web3
export function useWeb3() {
    const { library, account, activate, deactivate } = useWeb3React();
    
    const connect = async (connectorName) => {
        try {
            await activate(connectors[connectorName]);
        } catch (error) {
            console.error('è¿æ¥å¤±è´¥:', error);
        }
    };
    
    return { connect, disconnect: deactivate, account, library };
}
```

### 2. æ™ºèƒ½åˆçº¦äº¤äº’
```javascript
// åˆçº¦äº¤äº’æœåŠ¡
export class ContractService {
    static async createContractInstance(contractAddress, abi, signer) {
        return new ethers.Contract(contractAddress, abi, signer);
    }
    
    static async readContract(contract, method, args = []) {
        try {
            return await contract[method](...args);
        } catch (error) {
            console.error('è¯»å–åˆçº¦å¤±è´¥:', error);
            throw error;
        }
    }
    
    static async writeContract(contract, method, args = [], overrides = {}) {
        try {
            const tx = await contract[method](...args, overrides);
            return await tx.wait();
        } catch (error) {
            console.error('å†™å…¥åˆçº¦å¤±è´¥:', error);
            throw error;
        }
    }
}
```

### 3. äº‹ä»¶ç›‘å¬
```javascript
// ç›‘å¬åŒºå—é“¾äº‹ä»¶
export function useContractEvents(contract, eventName, callback) {
    useEffect(() => {
        if (!contract) return;
        
        const listener = (...args) => {
            callback(...args);
        };
        
        contract.on(eventName, listener);
        
        return () => {
            contract.off(eventName, listener);
        };
    }, [contract, eventName, callback]);
}
```

## ğŸŒ æ•°æ®æµå’Œäº¤äº’æµç¨‹

### DApp å·¥ä½œæµç¨‹ï¼š
1. **ç”¨æˆ·è®¿é—®** â†’ å‰ç«¯åº”ç”¨åŠ è½½
2. **é’±åŒ…è¿æ¥** â†’ ç”¨æˆ·æˆæƒ DApp è®¿é—®é’±åŒ…
3. **è¯»å–æ•°æ®** â†’ é€šè¿‡ RPC æŸ¥è¯¢åŒºå—é“¾çŠ¶æ€
4. **ç”¨æˆ·æ“ä½œ** â†’ å‰ç«¯è°ƒç”¨åˆçº¦å‡½æ•°
5. **äº¤æ˜“ç­¾å** â†’ é’±åŒ…å¼¹å‡ºç¡®è®¤äº¤æ˜“
6. **äº¤æ˜“å¹¿æ’­** â†’ å‘é€åˆ°åŒºå—é“¾ç½‘ç»œ
7. **åŒºå—ç¡®è®¤** â†’ ç­‰å¾…äº¤æ˜“è¢«æ‰“åŒ…
8. **çŠ¶æ€æ›´æ–°** â†’ å‰ç«¯æ ¹æ®æ–°çŠ¶æ€åˆ·æ–°ç•Œé¢

## ğŸ—„ï¸ å»ä¸­å¿ƒåŒ–å­˜å‚¨æ–¹æ¡ˆ

### IPFS é›†æˆ
```javascript
import { create } from 'ipfs-http-client';

const ipfs = create({
    host: 'ipfs.infura.io',
    port: 5001,
    protocol: 'https',
    headers: {
        authorization: `Basic ${Buffer.from(
            `${projectId}:${projectSecret}`
        ).toString('base64')}`
    }
});

export class IPFSService {
    static async uploadFile(file) {
        const added = await ipfs.add(file);
        return added.path;
    }
    
    static async uploadJSON(data) {
        const jsonString = JSON.stringify(data);
        const added = await ipfs.add(jsonString);
        return added.path;
    }
}
```

## ğŸ” å®‰å…¨å’Œæœ€ä½³å®è·µ

### 1. è¾“å…¥éªŒè¯
```javascript
// å‰ç«¯è¾“å…¥éªŒè¯
export function validateInputs(inputs) {
    const errors = {};
    
    if (!ethers.utils.isAddress(inputs.address)) {
        errors.address = 'æ— æ•ˆçš„åœ°å€æ ¼å¼';
    }
    
    if (isNaN(inputs.amount) || inputs.amount <= 0) {
        errors.amount = 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°é‡';
    }
    
    return errors;
}
```

### 2. é”™è¯¯å¤„ç†
```javascript
// ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
export function handleTransactionError(error) {
    if (error.code === 'INSUFFICIENT_FUNDS') {
        return 'ä½™é¢ä¸è¶³';
    } else if (error.code === 'USER_REJECTED') {
        return 'ç”¨æˆ·æ‹’ç»äº¤æ˜“';
    } else if (error.message.includes('execution reverted')) {
        return 'åˆçº¦æ‰§è¡Œå¤±è´¥';
    } else {
        return 'äº¤æ˜“å¤±è´¥ï¼Œè¯·é‡è¯•';
    }
}
```

## ğŸš€ éƒ¨ç½²å’Œå‘å¸ƒ

### å¤šç¯å¢ƒé…ç½®
```javascript
// ç¯å¢ƒé…ç½®
export const CONFIG = {
    development: {
        chainId: 31337, // Hardhat ç½‘ç»œ
        rpcUrl: 'http://localhost:8545',
        contractAddress: '0x5FbDB2315678afecb367f032d93F642f64180aa3'
    },
    testnet: {
        chainId: 5, // Goerli
        rpcUrl: `https://goerli.infura.io/v3/${process.env.INFURA_KEY}`,
        contractAddress: '0x...'
    },
    production: {
        chainId: 1, // ä»¥å¤ªåŠä¸»ç½‘
        rpcUrl: `https://mainnet.infura.io/v3/${process.env.INFURA_KEY}`,
        contractAddress: '0x...'
    }
};
```

è¿™æ ·çš„æ¶æ„ç¡®ä¿äº† DApp çš„å»ä¸­å¿ƒåŒ–ç‰¹æ€§ï¼ŒåŒæ—¶æä¾›äº†è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚æ¯ä¸ªç»„ä»¶éƒ½æ‰¿æ‹…ç€ç‰¹å®šçš„èŒè´£ï¼Œå…±åŒæ„æˆäº†ä¸€ä¸ªå®Œæ•´ã€å¯ç”¨çš„å»ä¸­å¿ƒåŒ–åº”ç”¨ã€‚